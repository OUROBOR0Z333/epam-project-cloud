# Infrastructure Network Topology Diagram

```
┌────────────────────────────────────────────────────────────────────────────────────┐
│                        INFRASTRUCTURE NETWORK TOPOLOGY                           │
├────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                    │
│  ┌─────────────────────────────────────────────────────────────────────────────┐  │
│  │                        GOOGLE CLOUD PLATFORM                                │  │
│  │                    Project: epamgcpdeployment2                             │  │
│  │                                                                             │  │
│  │  ┌─────────────────────────────────────────────────────────────────────────┐│  │
│  │  │                      VPC NETWORK                                        ││  │
│  │  │               movie-analyst-vpc-qa                                    ││  │
│  │  │                                                                         ││  │
│  │  │  INTERNET CONNECTIVITY                                                    ││  │
│  │  │  ┌─────────────────────────────────────────────────────────────────────┐││  │
│  │  │  │  Internet Gateway                                                  │││  │
│  │  │  │  Routes external traffic                                          │││  │
│  │  │  └─────────────────────────────────────────────────────────────────────┘││  │
│  │  │                                                                         ││  │
│  │  │  PUBLIC SUBNET (10.0.1.0/24)                                            ││  │
│  │  │  ┌─────────────────────────────────────────────────────────────────────┐││  │
│  │  │  │                      Bastion VM                                     │││  │
│  │  │  │                    bastion-qa                                      │││  │
│  │  │  │  ┌─────────────────────────────────────────────────────────────────┐│││  │
│  │  │  │  │  External IP: 34.61.107.53                                      ││││  │
│  │  │  │  │  Internal IP: 10.0.1.2                                          ││││  │
│  │  │  │  │  OS: Ubuntu 22.04 LTS                                           ││││  │
│  │  │  │  │  Role:                                                         ││││  │
│  │  │  │  │    - SSH Jump Host                                              ││││  │
│  │  │  │  │    - Secure access to private instances                        ││││  │
│  │  │  │  │  Tags: bastion-default                                         ││││  │
│  │  │  │  │  Service Account: bastion-sa-default                           ││││  │
│  │  │  │  └─────────────────────────────────────────────────────────────────┘│││  │
│  │  │  └─────────────────────────────────────────────────────────────────────┘││  │
│  │  │                                                                         ││  │
│  │  │  PRIVATE SUBNET (10.0.2.0/24)                                          ││  │
│  │  │  ┌─────────────────────────────────────────────────────────────────────┐││  │
│  │  │  │                      Backend VM                                     │││  │
│  │  │  │                     backend-qa                                      │││  │
│  │  │  │  ┌─────────────────────────────────────────────────────────────────┐│││  │
│  │  │  │  │  Internal IP: 10.0.2.2                                          ││││  │
│  │  │  │  │  OS: Ubuntu 22.04 LTS                                           ││││  │
│  │  │  │  │  Role:                                                         ││││  │
│  │  │  │  │    - Backend API service (Node.js/Express)                     ││││  │
│  │  │  │  │    - Cloud SQL Proxy                                            ││││  │
│  │  │  │  │  Tags: backend-default, app-default                           ││││  │
│  │  │  │  │  Service Account: app-sa-default                               ││││  │
│  │  │  │  │  Services:                                                     ││││  │
│  │  │  │  │    - Cloud SQL Proxy (localhost:3306)                          ││││  │
│  │  │  │  │    - Backend API (port 3000)                                    ││││  │
│  │  │  │  │    - PM2 Process Manager                                        ││││  │
│  │  │  │  └─────────────────────────────────────────────────────────────────┘│││  │
│  │  │  │                                                                     │││  │
│  │  │  │                      Frontend VM                                    │││  │
│  │  │  │                   frontend-qa-vpr8                                 │││  │
│  │  │  │  ┌─────────────────────────────────────────────────────────────────┐│││  │
│  │  │  │  │  Internal IP: 10.0.2.3                                          ││││  │
│  │  │  │  │  OS: Ubuntu 22.04 LTS                                           ││││  │
│  │  │  │  │  Role:                                                         ││││  │
│  │  │  │  │    - Frontend web service (Node.js/Express)                     ││││  │
│  │  │  │  │  Tags: frontend-default, app-default                           ││││  │
│  │  │  │  │  Service Account: app-sa-default                               ││││  │
│  │  │  │  │  Services:                                                     ││││  │
│  │  │  │  │    - Frontend Web UI (port 3030)                                ││││  │
│  │  │  │  │    - PM2 Process Manager                                        ││││  │
│  │  │  │  └─────────────────────────────────────────────────────────────────┘│││  │
│  │  │  └─────────────────────────────────────────────────────────────────────┘││  │
│  │  │                                                                         ││  │
│  │  │  DATABASE SUBNET (10.3.30.0/24)                                        ││  │
│  │  │  ┌─────────────────────────────────────────────────────────────────────┐││  │
│  │  │  │                   Cloud SQL Database                               │││  │
│  │  │  │                     movie-db-qa                                    │││  │
│  │  │  │  ┌─────────────────────────────────────────────────────────────────┐│││  │
│  │  │  │  │  Private IP: 10.3.30.5                                          ││││  │
│  │  │  │  │  Database Engine: MySQL 8.0                                     ││││  │
│  │  │  │  │  Database: movie_db                                             ││││  │
│  │  │  │  │  User: app_user                                                 ││││  │
│  │  │  │  │  Connection:                                                     ││││  │
│  │  │  │  │    - Private IP (10.3.30.5)                                    ││││  │
│  │  │  │  │    - Accessed via Cloud SQL Proxy                              ││││  │
│  │  │  │  └─────────────────────────────────────────────────────────────────┘│││  │
│  │  │  └─────────────────────────────────────────────────────────────────────┘││  │
│  │  │                                                                         ││  │
│  │  │  LOAD BALANCER                                                          ││  │
│  │  │  ┌─────────────────────────────────────────────────────────────────────┐││  │
│  │  │  │  Global External IP: 34.107.139.237                                │││  │
│  │  │  │  Target: frontend-qa-vpr8 (port 3030)                               │││  │
│  │  │  │  Role:                                                             │││  │
│  │  │  │    - Distribute incoming web traffic                               │││  │
│  │  │  │    - SSL termination (if configured)                              │││  │
│  │  │  │    - Health checks                                                │││  │
│  │  │  └─────────────────────────────────────────────────────────────────────┘││  │
│  │  │                                                                         ││  │
│  │  │  ROUTING & NETWORKING                                                   ││  │
│  │  │  ┌─────────────────────────────────────────────────────────────────────┐││  │
│  │  │  │  Router: router-default                                            │││  │
│  │  │  │  NAT Gateway: nat-gateway-default                                  │││  │
│  │  │  │  Routes outbound traffic from private subnets                      │││  │
│  │  │  └─────────────────────────────────────────────────────────────────────┘││  │
│  │  └─────────────────────────────────────────────────────────────────────────┘│  │
│  └───────────────────────────────────────────────────────────────────────────────┘  │
└──────────────────────────────────────────────────────────────────────────────────────┘

┌────────────────────────────────────────────────────────────────────────────────────┐
│                        NETWORK CONNECTIVITY                                        │
├────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                    │
│  INTERNET TRAFFIC FLOW                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────────┐  │
│  │  Internet → Load Balancer (34.107.139.237)                                 │  │
│  │              ↓                                                              │  │
│  │              Frontend VM (10.0.2.3:3030)                                   │  │
│  │              ↓                                                              │  │
│  │              Backend VM (10.0.2.2:3000)                                    │  │
│  └─────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                    │
│  INTERNAL TRAFFIC FLOW                                                             │
│  ┌─────────────────────────────────────────────────────────────────────────────┐  │
│  │  Frontend VM (10.0.2.3) → Backend VM (10.0.2.2:3000)                        │  │
│  │                       API calls for data                                   │  │
│  │                                                                              │  │
│  │  Backend VM (localhost:3306) → Cloud SQL (10.3.30.5:3306)                 │  │
│  │  Through Cloud SQL Proxy                                                     │  │
│  │                                                                              │  │
│  │  Bastion VM (10.0.1.2) ↔ Private VMs                                        │  │
│  │  SSH access for administration                                                │  │
│  └─────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                    │
│  OUTBOUND TRAFFIC                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────────────┐  │
│  │  Private VMs → NAT Gateway → Internet                                       │  │
│  │  For package updates, external API calls, etc.                              │  │
│  └─────────────────────────────────────────────────────────────────────────────┘  │
└────────────────────────────────────────────────────────────────────────────────────┘

┌────────────────────────────────────────────────────────────────────────────────────┐
│                        FIREWALL RULES                                              │
├────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                    │
│  INGRESS RULES                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────────────┐  │
│  │  Allow SSH from Internet                                                    │  │
│  │  Source: 0.0.0.0/0                                                          │  │
│  │  Target: bastion-default (port 22)                                          │  │
│  │  Purpose: Direct SSH access to bastion host                                │  │
│  └─────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                    │
│  ┌─────────────────────────────────────────────────────────────────────────────┐  │
│  │  Allow HTTP/HTTPS from Internet                                             │  │
│  │  Source: 0.0.0.0/0                                                          │  │
│  │  Target: load-balancer-default (ports 80, 443)                              │  │
│  │  Purpose: Web traffic to frontend                                          │  │
│  └─────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                    │
│  ┌─────────────────────────────────────────────────────────────────────────────┐  │
│  │  Allow Internal Communication                                               │  │
│  │  Source: 10.0.0.0/8                                                         │  │
│  │  Target: app-default (ports 0-65535 TCP/UDP)                                │  │
│  │  Purpose: Internal service communication                                   │  │
│  └─────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                    │
│  ┌─────────────────────────────────────────────────────────────────────────────┐  │
│  │  Allow Bastion to Private                                                   │  │
│  │  Source: bastion-default                                                   │  │
│  │  Target: app-default (ports 22, 80, 443, 3000, 3030)                        │  │
│  │  Purpose: Bastion access to private instances                              │  │
│  └─────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                    │
│  ┌─────────────────────────────────────────────────────────────────────────────┐  │
│  │  Allow Load Balancer to Backend                                             │  │
│  │  Source: load-balancer-default                                              │  │
│  │  Target: backend-default (port 3000)                                        │  │
│  │  Purpose: Load balancer forwarding to backend API                         │  │
│  └─────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                    │
│  EGRESS RULES                                                                      │
│  ┌─────────────────────────────────────────────────────────────────────────────┐  │
│  │  Allow Private Egress                                                       │  │
│  │  Source: app-default                                                        │  │
│  │  Target: 0.0.0.0/0 (ports 443, 80, 53 TCP/UDP)                              │  │
│  │  Purpose: Outbound internet access for updates and API calls               │  │
│  └─────────────────────────────────────────────────────────────────────────────┘  │
└────────────────────────────────────────────────────────────────────────────────────┘

┌────────────────────────────────────────────────────────────────────────────────────┐
│                        COMPONENT RELATIONSHIPS                                    │
├────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                    │
│  HIERARCHICAL STRUCTURE                                                            │
│  Google Cloud Project (epamgcpdeployment2)                                         │
│  └── VPC Network (movie-analyst-vpc-qa)                                          │
│      ├── Public Subnet (10.0.1.0/24)                                               │
│      │   └── Bastion VM (bastion-qa)                                             │
│      ├── Private Subnet (10.0.2.0/24)                                             │
│      │   ├── Backend VM (backend-qa)                                             │
│      │   └── Frontend VM (frontend-qa-vpr8)                                      │
│      ├── Database Subnet (10.3.30.0/24)                                          │
│      │   └── Cloud SQL Database (movie-db-qa)                                   │
│      └── Load Balancer                                                             │
│          └── Global External IP (34.107.139.237)                                 │
│                                                                                    │
│  NETWORK PATHS                                                                     │
│  1. Internet → Load Balancer → Frontend VM                                         │
│  2. Frontend VM → Backend VM (API calls)                                          │
│  3. Backend VM → Cloud SQL (via Cloud SQL Proxy)                                 │
│  4. Bastion VM ↔ Private VMs (SSH administration)                               │
│  5. Private VMs → NAT Gateway → Internet (outbound traffic)                      │
└────────────────────────────────────────────────────────────────────────────────────┘